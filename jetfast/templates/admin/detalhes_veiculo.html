{% extends 'admin/base_site.html' %}
{% load static %}

{% block title %}Detalhes do Ve√≠culo - {{ veiculo.placa }} - JetFast{% endblock %}

{% block branding %}
<h1 id="site-name"><a href="{% url 'admin:index' %}">JetFast</a></h1>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<style>
    /* Defini√ß√£o de Cores */
    :root {
        --accent-color: #fdb02e;
        --accent-dark: #e59a1f;
        --admin-black: #000; /* Cor padr√£o do header do Django ou use #000 */
        --jetfast-blue: #007bff;
        --organico-green: #28a745;
    }

    /* Mant√©m o Header padr√£o/preto */
    #header {
        background: #000 !important; /* Cor azulada padr√£o do Django ou mude para black */
    }

    /* Se√ß√µes (Modules) com a cor de destaque #fdb02e */
    .module h2 {
        background: var(--accent-color) !important;
        color: #000 !important;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* Bot√µes com a cor de destaque */
    .button, input[type=submit], .submit-row a.default {
        background: var(--accent-color) !important;
        color: #000 !important;
        font-weight: bold;
        border: none;
    }

    .button:hover {
        background: var(--accent-dark) !important;
        color: #000 !important;
    }

    /* Ajustes das Tabelas */
    .info-table th {
        background: #fdfdfd;
        color: #555;
        text-align: left;
        width: 20%;
        padding: 12px;
        border-bottom: 1px solid #eee;
    }

    .info-table td {
        padding: 12px;
        border-bottom: 1px solid #eee;
    }

    .history-table thead th {
        background: #f8f8f8;
        border-bottom: 2px solid var(--accent-color);
        padding: 12px;
        text-align: left;
    }

    .observacao-cell {
        max-width: 200px;
        word-wrap: break-word;
        white-space: pre-wrap;
        font-size: 0.9em;
        color: #666;
    }

    /* Badge para Tipo de Cliente */
    .badge-tipo-cliente {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 0.9em;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .badge-jetfast {
        background: var(--jetfast-blue);
        color: white;
    }

    .badge-organico {
        background: var(--organico-green);
        color: white;
    }

    /* Highlight para tipo de cliente */
    .tipo-cliente-highlight {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid var(--accent-color);
        margin-bottom: 20px;
    }

    .tipo-cliente-highlight h3 {
        margin: 0 0 10px 0;
        color: #333;
        font-size: 1.1em;
    }

    .tipo-cliente-info {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .tipo-cliente-icon {
        font-size: 2em;
    }
</style>
{% endblock %}

{% block content %}
<div id="content-main">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h1>Ficha do Ve√≠culo: <span style="color: var(--accent-dark);">{{ veiculo.placa }}</span></h1>
        <a href="{% url 'admin:jetfast_veiculo_changelist' %}" class="button">Voltar</a>
    </div>

    <div class="module">
        <h2>Dados do Propriet√°rio e Ve√≠culo</h2>
        <table class="info-table" style="width: 100%; border-collapse: collapse;">
            <tr>
                <th>Propriet√°rio:</th>
                <td>{{ veiculo.nome }}</td>
                <th>Telefone:</th>
                <td>{{ veiculo.telefone|default:"N√£o informado" }}</td>
            </tr>
            <tr>
                <th>Marca/Modelo:</th>
                <td>{{ veiculo.modelo_veiculo.marca }} - {{ veiculo.modelo_veiculo.nome }}</td>
                <th>Categoria:</th>
                <td>{{ veiculo.categoria.nome|default:"Sem categoria" }}</td>
            </tr>
            <tr>
                <th>Tipo de Cliente:</th>
                <td>
                    {% if veiculo.tipo_cliente == 'JETFAST' %}
                        <span class="badge-tipo-cliente badge-jetfast">‚≠ê JetFast</span>
                    {% else %}
                        <span class="badge-tipo-cliente badge-organico">üå± Org√¢nico</span>
                    {% endif %}
                </td>
                <th>Data de Cadastro:</th>
                <td>{{ veiculo.data_cadastro|date:"d/m/Y \√†\s H:i" }}</td>
            </tr>
        </table>
    </div>

    <div class="module" style="margin-top: 30px;">
        <h2>Hist√≥rico Completo de Lavagens</h2>
        <table class="history-table" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Chegada</th>
                    <th>Entrada Pista</th>
                    <th>Sa√≠da Final</th>
                    <th>Colab. Externa</th>
                    <th>Colab. Interna</th>
                    <th>Observa√ß√£o</th>
                </tr>
            </thead>
            <tbody>
                {% for lavagem in lavagens_realizadas %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;"><strong>{{ lavagem.horario_chegada|date:"d/m/Y" }}</strong></td>
                    <td style="padding: 12px;">{{ lavagem.horario_chegada|date:"H:i" }}</td>
                    <td style="padding: 12px;">{{ lavagem.horario_pista|date:"H:i"|default:"---" }}</td>
                    <td style="padding: 12px;">{{ lavagem.horario_saida|date:"H:i"|default:"---" }}</td>
                    <td style="padding: 12px;">{{ lavagem.colaborador_externa.nome|default:"---" }}</td>
                    <td style="padding: 12px;">{{ lavagem.colaborador_interna.nome|default:"---" }}</td>
                    <td style="padding: 12px;" class="observacao-cell">
                        {% if lavagem.observacao %}
                            {{ lavagem.observacao }}
                        {% else %}
                            <span style="color: #ccc;">---</span>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7" style="padding: 30px; text-align: center; color: #666;">
                        Este ve√≠culo ainda n√£o possui registros de lavagem.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Estat√≠sticas do ve√≠culo (opcional) -->
    {% if lavagens_realizadas %}
    <div class="module" style="margin-top: 30px;">
        <h2>Estat√≠sticas do Ve√≠culo</h2>
        <table class="info-table" style="width: 100%; border-collapse: collapse;">
            <tr>
                <th>Total de Lavagens:</th>
                <td><strong>{{ lavagens_realizadas|length }}</strong></td>
                <th>√öltima Lavagem:</th>
                <td>{{ lavagens_realizadas.0.horario_chegada|date:"d/m/Y \√†\s H:i" }}</td>
            </tr>
        </table>
    </div>
    {% endif %}
</div>
{% endblock %}